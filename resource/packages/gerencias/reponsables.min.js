var RESPONSABLES=RESPONSABLES||{};RESPONSABLES.responsable=function(e){"use strict";var t=e("table#tb_responsables"),s=e("#ID_GERENCIA_GENERAL"),o=function(){e("#btn_search").on("click",function(){t.bootstrapTable("refresh")})},n=function(){var s=e.extend(!0,{},e.extend(!0,{},MPC.config).bootstrapTable);s.idField="ID_RESPONSABLE",s.search=!1,s.url=Request.BaseUrl+"/gerencias/responsables/list",s.queryParams=function(t){return t.filter_type=e("#cbo_filter_type").val(),t.filter_value=e("#txt_filter_value").val(),t.filter_year=e("#txt_filter_year").val(),t},s.columns=[{field:"NOMBRE_GERENCIA",title:"GERENCIA",align:"center",sortable:!0},{field:"DATOS",title:"RESPONSABLE",align:"center",sortable:!0,width:"*"},{field:"NNUMERO_DOCUMENTO_PERSONA",title:"DOC. IDENTIDAD",align:"center",sortable:!0,width:"*"},{field:"action",title:" ACCIONES",align:"center",width:"100px",formatter:i,events:{"click .edit":r}}],t.bootstrapTable(s)},a=function(){s.on("change",function(){e.post(Request.BaseUrl+"/"+Request.UrlHash.m+"/response/getSubGerencia",{ID_GERENCIA:e(this).val()},function(t){e("#ID_SUBGERENCIA").html(t.option)},"json")})},i=function(e,t){var s='<button id="btn-edit-'+t.ID_RESPONSABLE+'" class="btn-actions edit btn btn-xs btn-complete" data-id="'+t.ID_RESPONSABLE+'" title="Editar Registro"><i class="fa fa-edit"></i></button>&nbsp;';return s},l=function(){e("#btn_new_responsable").on("click",function(){e.post(Request.BaseUrl+"/gerencias/responsables/responsable",{},function(e){bootbox.dialog({closeButton:!1,message:e.layer}),E()},"json")})},r=function(t,s,o){e.post(Request.BaseUrl+"/gerencias/responsables/EditReponsable",{id:o.ID_GERENCIA_RESPONSABLE},function(e){bootbox.dialog({closeButton:!1,message:e.layer}),c()},"json")},c=function(){f(),e("#btn_close_edit").on("click",function(){bootbox.hideAll()}),e("#ID_GERENCIA").on("change",function(){e.post(Request.BaseUrl+"/patrimonio/response/getSubGerencia",{ID_GERENCIA:e(this).val()},function(t){e("#ID_SUB_GERENCIA").html(t.option)},"json")}),e("#NUMERO_DOCUMENTO_PERSONA").on("blur",function(){{var t=e(this).val();e("#TIPO_DOCUMENTO_PERSONA").val()}e.post(Request.BaseUrl+"/patrimonio/response/searchpersona",{numero_documento:t},function(t){if(t.STATE)if(t.RESPONSABLE){e(this).val("");var s=[];s.message='<div class="text-center"><i class="fa fa-warning"></i> Persona ya registrada</div>',s.style="flip",s.position="top",s.type="warning",s.showClose=!0,e(".modal-content").pgNotification(s).show()}else{var s=[];s.message='<div class="text-center"><i class="fa fa-check"></i> Resultados encontrados</div>',s.style="flip",s.position="top",s.type="success",s.showClose=!0,e(".modal-content").pgNotification(s).show(),e("#ID_PERSONA").val(t.PERSONA.ID_PERSONA),e("#NOMBRES_PERSONA").val(t.PERSONA.NOMBRES_PERSONA),e("#APELLIDO_PATERNO_PERSONA").val(t.PERSONA.APELLIDO_PATERNO_PERSONA),e("#APELLIDO_MATERNO_PERSONA").val(t.PERSONA.APELLIDO_MATERNO_PERSONA),e("#NOMBRES_PERSONA").attr("readonly",""),e("#APELLIDO_PATERNO_PERSONA").attr("readonly",""),e("#APELLIDO_MATERNO_PERSONA").attr("readonly","")}else{var s=[];s.message='<div class="text-center"><i class="fa fa-warning"></i> No se encontraron resultados</div>',s.style="flip",s.position="top",s.type="danger",s.showClose=!0,e(".modal-content").pgNotification(s).show()}},"json")}),e("#frm_edit_responsable").on("submit",function(){return e.post(Request.BaseUrl+"/gerencias/responsables/SaveEditResponsable",e("#frm_edit_responsable").serialize(),function(s){if(s.STATE){t.bootstrapTable("refresh"),bootbox.hideAll();var o=[];o.message='<div class="text-center"><i class="fa fa-check"></i> Datos guardados</div>',o.style="flip",o.position="top",o.type="success",o.showClose=!0,e("body").pgNotification(o).show()}else{var o=[];o.message='<div class="text-center"><i class="fa fa-warning"></i> No se pudieron guardar los datos</div>',o.style="flip",o.position="top",o.type="danger",o.showClose=!0,e(".modal-content").pgNotification(o).show(),e("#dv_save").html('<button type="button" class="btn btn-danger" id="btn_close"><i class="fa fa-close"></i> Cancelar</button><button type="submit" class="btn btn-info" id="btn_save"><i class="fa fa-save"></i> Guardar</button>')}},"json"),!1})},E=function(){f(),e("#btn_close").on("click",function(){bootbox.hideAll()}),e("#ID_GERENCIA").on("change",function(){e.post(Request.BaseUrl+"/patrimonio/response/getSubGerencia",{ID_GERENCIA:e(this).val()},function(t){e("#ID_SUB_GERENCIA").html(t.option)},"json")}),e("#NUMERO_DOCUMENTO_PERSONA").on("blur",function(){{var t=e(this).val();e("#TIPO_DOCUMENTO_PERSONA").val()}e.post(Request.BaseUrl+"/patrimonio/response/searchpersona",{numero_documento:t},function(t){if(t.STATE)if(t.RESPONSABLE){e(this).val("");var s=[];s.message='<div class="text-center"><i class="fa fa-warning"></i> Persona ya registrada</div>',s.style="flip",s.position="top",s.type="warning",s.showClose=!0,e(".modal-content").pgNotification(s).show()}else{var s=[];s.message='<div class="text-center"><i class="fa fa-check"></i> Resultados encontrados</div>',s.style="flip",s.position="top",s.type="success",s.showClose=!0,e(".modal-content").pgNotification(s).show(),e("#ID_PERSONA").val(t.PERSONA.ID_PERSONA),e("#NOMBRES_PERSONA").val(t.PERSONA.NOMBRES_PERSONA),e("#APELLIDO_PATERNO_PERSONA").val(t.PERSONA.APELLIDO_PATERNO_PERSONA),e("#APELLIDO_MATERNO_PERSONA").val(t.PERSONA.APELLIDO_MATERNO_PERSONA),e("#NOMBRES_PERSONA").attr("readonly",""),e("#APELLIDO_PATERNO_PERSONA").attr("readonly",""),e("#APELLIDO_MATERNO_PERSONA").attr("readonly","")}else{var s=[];s.message='<div class="text-center"><i class="fa fa-warning"></i> No se encontraron resultados</div>',s.style="flip",s.position="top",s.type="danger",s.showClose=!0,e(".modal-content").pgNotification(s).show()}},"json")}),e("#frm_responsable").on("submit",function(){return e.post(Request.BaseUrl+"/gerencias/responsables/save",e("#frm_responsable").serialize(),function(s){if(s.STATE){t.bootstrapTable("refresh"),bootbox.hideAll();var o=[];o.message='<div class="text-center"><i class="fa fa-check"></i> Datos guardados</div>',o.style="flip",o.position="top",o.type="success",o.showClose=!0,e("body").pgNotification(o).show()}else{var o=[];o.message='<div class="text-center"><i class="fa fa-warning"></i> No se pudieron guardar los datos</div>',o.style="flip",o.position="top",o.type="danger",o.showClose=!0,e(".modal-content").pgNotification(o).show(),e("#dv_save").html('<button type="button" class="btn btn-danger" id="btn_close"><i class="fa fa-close"></i> Cancelar</button><button type="submit" class="btn btn-info" id="btn_save"><i class="fa fa-save"></i> Guardar</button>')}},"json"),!1})},f=function(){function t(e){var t=e.which?e.which:event.keyCode;return 45==t||32==t?!0:48>t||t>57?!1:!0}function s(e){var t=e.which?e.which:event.keyCode;return 45==t||32==t||46==t?!0:48>t||t>57?!1:!0}e(".mayusculas").keyup(function(){e(this).val(e(this).val().toUpperCase())}),e(".validar_numeros").keypress(function(e){return t(e,this)}),e(".validar_decimales").keypress(function(e){return s(e,this)})};return{init:function(){n(),o(),l(),a()}}}(window.jQuery),function(){RESPONSABLES.responsable.init()}(window.jQuery);