var OVER=OVER||{};OVER.reportes=function(e){"use strict";var t=e.extend(!0,{},MPC.config),a=e("#cboFilterAnio"),n=e("#cboFilterMeses"),i=e("#cboFilterEstado"),o=e("#cboFilterDias"),l=e("#cboFilterEnfermedades"),r=e("#reportEnfermedadesEtareo"),d=e("#reportEnfermedadesResume"),s=e("#reportStateCarnetDetails"),p=e("#reportStateCarnetResumen"),c=["#4E191F","#064089","#476388","#A71A22","#D391C1","#13924D","#9A6428"],m=function(){CanvasJS.addColorSet("enfermedades",c);var e=new CanvasJS.Chart(d.attr("id"),{title:{text:"Examen Médico"},animationEnabled:!0,colorSet:"enfermedades",exportFileName:"Reporte_Enferemedades_Resumen_"+(new Date).getTime(),exportEnabled:!0,axisX:{title:"Enfermedades",gridThickness:1,tickLength:10,labelFontSize:14,interval:1},data:[{type:"column",toolTipContent:"{label}: <strong>{y}</strong>",indexLabel:"{y}",indexLabelPlacement:"outside",indexLabelOrientation:"horizontal",dataPoints:[{y:0,label:"Por Vencer"},{y:0,label:"Vencido"}]}]});e.render(),v(e)},u=function(){var e=new CanvasJS.Chart(r.attr("id"),{animationEnabled:!0,exportFileName:"Reporte_Enferemedades_Etario_"+(new Date).getTime(),exportEnabled:!0,axisX:{interval:1,gridThickness:1,tickLength:10,labelFontSize:10},data:[{type:"bar",name:"companies",axisYType:"secondary",color:c[0],indexLabel:"{y}",indexLabelPlacement:"outside",indexLabelOrientation:"horizontal",dataPoints:[]}]});e.render(),f(1,e),l.on("change",function(){f(this.value,e)})},b=function(){var e=new CanvasJS.Chart(p.attr("id"),{title:{text:"Vigencia  - Carnet Sanidad"},exportFileName:"Reporte_Carner_Vigencia_Resumen_"+(new Date).getTime(),exportEnabled:!0,animationEnabled:!0,legend:{verticalAlign:"bottom",horizontalAlign:"center"},data:[{indexLabelFontSize:12,indexLabelFontFamily:"Monospace",indexLabelFontColor:"white",indexLabelLineColor:"darkgrey",indexLabelPlacement:"inside",type:"pie",showInLegend:!0,toolTipContent:"{name}: <strong>{y}</strong>",indexLabel:"#percent%",dataPoints:[{y:0,name:"Por Vencer"},{y:0,name:"Vencido"}]}]});e.render(),x(e),a.on("change",function(){x(e)})},f=function(a,n){e.post(t.moduleUrl+"default/EnferemedadEtareo",{enfermedad:a},function(e){n.options.data[0].color=c[parseInt(a)-1],n.options.data[0].dataPoints=e.data,n.render()})},v=function(a){e.post(t.moduleUrl+"default/EnferemedadesResumen",{},function(e){a.options.data[0].dataPoints=e.data,a.render()})},x=function(n){e.post(t.moduleUrl+"default/CarnetStatusResumen",{anio:a.val()},function(e){n.options.data[0].dataPoints=e.data,n.render()})},h=function(){s.empty();var t=new CanvasJS.Chart(s.attr("id"),{title:{text:"Detalle ("+a.val()+")"},exportFileName:"Reporte_Carner_Vigencia_Detalle_"+(new Date).getTime(),exportEnabled:!0,toolTip:{shared:!0},zoomEnabled:!0,axisY:{minimum:0},axisX:{title:"Meses",gridThickness:1,tickLength:10,labelFontSize:10,interval:1},animationEnabled:!0,data:[]});t.render(),g(t),i.on("change",function(){g(t,{anio:a.val(),mes:n.val(),estado:this.value})}),n.on("change",function(){0==this.value?(g(t),t.options.axisX.title="Meses",t.options.title.text="Detalle ("+a.val()+")"):(t.options.title.text="Detalle ("+e(this).find("option:selected").text()+" -"+a.val()+")",t.options.axisX.title="Días",g(t,{anio:a.val(),mes:parseInt(this.value),estado:i.val()}))})},g=function(n,l){var l=l||{anio:a.val()};e.post(t.moduleUrl+"overview/CarnetStatusDetails",l,function(t){n.options.data=t.data,n.render(),t.days.length>0&&(i.prop("disabled",!1),o.empty().html("<option value='0'>Todos</option>").prop("disabled",!1),e.each(t.days,function(e,t){o.append("<option value='"+t+"'>"+t+"</option>")}))})},E=function(o){var l=e.extend(!0,{},t.bootstrapTable);l.idField="dni",l.pageSize=5,l.url=t.moduleUrl+"overview/listCarnetStatusDetailsDays",l.queryParams=function(e){return e.anio=a.val(),e.mes=n.val(),e.estado=i.val(),e.dia=o,e},l.exportDataType="all",l.showExport=!0,l.columns=[{field:"dni",title:"DNI",align:"center",sortable:!0,width:"100px"},{field:"solicitante",title:"Apellidos y Nombres",align:"left",sortable:!0},{field:"distrito",title:"Distrito",align:"left",sortable:!0},{field:"empresa",title:"Empresa",align:"left",sortable:!0}];var r=e("<div>").addClass("table-responsive"),d=e("<table>").addClass("table-app table table-bordered table-striped"),p=e("<thead>");d.html(p),r.html(d),d.bootstrapTable(l),s.html(r)},C=function(){e("#btnReportStateDetails").on("click",function(){n.prop("disabled",!1),h()}),o.on("change",function(){0==this.value?(i.prop("disabled",!1),h(),i.trigger("change")):(i.prop("disabled",!0),s.empty(),E(this.value))}),u(),m(),b()};return{init:C}}(window.jQuery),$(function(){OVER.reportes.init()});