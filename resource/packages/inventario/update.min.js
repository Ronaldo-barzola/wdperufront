var UPDATE=UPDATE||{},urlController=Request.BaseUrl+"/"+Request.UrlHash.m;UPDATE.update=function(e){"use strict";var t=e.extend(!0,{},MPC.config),o=e("#frmDataInventario"),s=(e("#chk_empresa"),e("#cbo_empresa"),e("#txt_empresa"),e("#upImage"),e("#clearForm"),e("#solicitante_foto"),e("#cropping"),e("#NUMERO_DOCUMENTO_PERSONA"),e("#REGISTRAR_PERSONA")),n=(e("#id_departamento"),e("#ID_CUENTA")),a=(e("#id_provincia"),e("#id_distrito"),e("#imagePreview"),e("#ID_GERENCIA_GENERAL")),i=e("#ID_SUBGERENCIA"),r={errorPlacement:function(e,t){e.insertAfter(t)},submitHandler:function(){e("#FECHA_PECOSA").val(),e("#FECHA_ADQUISICION").val(),e("#FECHA_INICIO_ASEGURADO").val(),e("#FECHA_FIN_ASEGURADO").val();bootbox.confirm({title:"Atención!",message:"<div class='text-center'><h5>¿Los datos ingresados son los correctos?</h5></div>",className:"modal fade stick-up",size:"small",buttons:{confirm:{label:"Si",className:"btn-success"},cancel:{label:"No",className:"btn-default"}},callback:function(t){if(t){var s=!0;s&&e.ajax({type:"post",dataType:"json",url:urlController+"/principal/UpdateDataInventario",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:o.serialize(),success:function(e){e.estado===!0&&(location.href=urlController+"/principal/inventario",N("body","INVENTARIO REGISTRADO","success","bar"))}})}}})},rules:{skills:"required"},messages:{skills:"Campo requerido"}},l=function(){c(),o.validate(r),u(),p(),A(),t.datepicker.startView=2},c=function(){i.on("change",function(){e.post(Request.BaseUrl+"/patrimonio/response/getSubResponsable",{ID_SUBGERENCIA:e(this).val()},function(t){e("#ID_RESPONSABLE").html(t.option)},"json")})},u=function(){a.on("change",function(){e.post(Request.BaseUrl+"/patrimonio/response/getSubGerencia",{ID_GERENCIA:e(this).val()},function(t){e("#ID_SUBGERENCIA").html(t.option)},"json")})},p=function(){s.on("click",function(){e.post(Request.BaseUrl+"/patrimonio/principal/NuevaPersona",function(e){bootbox.dialog({closeButton:!1,message:e.layer}),E()},"json")})},E=function(){e("#btn_close").on("click",function(){bootbox.hideAll()}),e("#ID_GERENCIA").on("change",function(){e.post(Request.BaseUrl+"/patrimonio/response/getSubGerencia",{ID_GERENCIA:e(this).val()},function(t){e("#ID_SUB_GERENCIA").html(t.option)},"json")}),e("#NUMERO_DOCUMENTO_PERSONA").on("blur",function(){{var t=e(this).val();e("#TIPO_DOCUMENTO_PERSONA").val()}e.post(Request.BaseUrl+"/patrimonio/response/searchpersona",{numero_documento:t},function(t){if(t.STATE)if(t.RESPONSABLE){e(this).val("");var o=[];o.message='<div class="text-center"><i class="fa fa-warning"></i> Persona ya registrada</div>',o.style="flip",o.position="top",o.type="warning",o.showClose=!0,e(".modal-content").pgNotification(o).show()}else{var o=[];o.message='<div class="text-center"><i class="fa fa-check"></i> Resultados encontrados</div>',o.style="flip",o.position="top",o.type="success",o.showClose=!0,e(".modal-content").pgNotification(o).show(),e("#ID_PERSONA").val(t.PERSONA.ID_PERSONA),e("#NOMBRES_PERSONA").val(t.PERSONA.NOMBRES_PERSONA),e("#APELLIDO_PATERNO_PERSONA").val(t.PERSONA.APELLIDO_PATERNO_PERSONA),e("#APELLIDO_MATERNO_PERSONA").val(t.PERSONA.APELLIDO_MATERNO_PERSONA),e("#NOMBRES_PERSONA").attr("readonly",""),e("#APELLIDO_PATERNO_PERSONA").attr("readonly",""),e("#APELLIDO_MATERNO_PERSONA").attr("readonly","")}else{var o=[];o.message='<div class="text-center"><i class="fa fa-warning"></i> No se encontraron resultados</div>',o.style="flip",o.position="top",o.type="danger",o.showClose=!0,e(".modal-content").pgNotification(o).show()}},"json")}),e("#frm_respo").on("submit",function(){return e.post(Request.BaseUrl+"/gerencias/responsables/save",e("#frm_respo").serialize(),function(t){if(t.STATE){bootbox.hideAll();var o=[];o.message='<div class="text-center"><i class="fa fa-check"></i> Datos guardados</div>',o.style="flip",o.position="top",o.type="success",o.showClose=!0,e("body").pgNotification(o).show()}else{var o=[];o.message='<div class="text-center"><i class="fa fa-warning"></i> No se pudieron guardar los datos</div>',o.style="flip",o.position="top",o.type="danger",o.showClose=!0,e(".modal-content").pgNotification(o).show(),e("#dv_save").html('<button type="button" class="btn btn-danger" id="btn_close"><i class="fa fa-close"></i> Cancelar</button><button type="submit" class="btn btn-info" id="btn_save"><i class="fa fa-save"></i> Guardar</button>')}},"json"),!1})},A=function(){n.on("change",function(){var t=(e("#numero_documento").val(),e("#CODIGO_GRUPO").val()),o=e("#CODIGO_CLASE").val(),s=e("#ID_CUENTA").val();e.post(Request.BaseUrl+"/patrimonio/response/getNumCuenta",{cod_grupo:t,cod_clase:o,tipo_cuenta:s},function(t){e("#NUM_CUENTA_CONTABLE").val(t.cuenta),e("#NUM_CUENTA").text("NUMERO CUENTA CONTABLE: "+t.cuenta)},"json")})},N=function(t,o,s,n){e(t).pgNotification({style:n,showClose:!1,message:"<center><b>"+o+"</b></center>",position:"top",timeout:3e3,type:s}).show()};return{init:l}}(window.jQuery),function(){UPDATE.update.init()}(window.jQuery);