var HISTORY=HISTORY||{},urlController=Request.BaseUrl+"/"+Request.UrlHash.m;HISTORY.history=function(I){"use strict";var E=I.extend(!0,{},MPC.config),N=I("#frmHistory"),A=(I("#chk_empresa"),I("#cbo_empresa"),I("#txt_empresa"),I("#upImage"),I("#clearForm"),I("#solicitante_foto"),I("#cropping"),I("#NUMERO_DOCUMENTO_PERSONA"),I("#REGISTRAR_PERSONA")),e=(I("#id_departamento"),I("#ID_CUENTA")),_=(I("#id_provincia"),I("#id_distrito"),I("#imagePreview"),I("#ID_GERENCIA_GENERAL")),a=I("#ID_SUBGERENCIA"),t=I("#FECHA_MODIFICACION"),O={errorPlacement:function(I,E){I.insertAfter(E)},submitHandler:function(){I("#FECHA_PECOSA").val(),I("#FECHA_ADQUISICION").val(),I("#FECHA_INICIO_ASEGURADO").val(),I("#FECHA_FIN_ASEGURADO").val();bootbox.confirm({title:"Atención!",message:"<div class='text-center'><h5>¿Los datos ingresados son los correctos?</h5></div>",className:"modal fade stick-up",size:"small",buttons:{confirm:{label:"Si",className:"btn-success"},cancel:{label:"No",className:"btn-default"}},callback:function(E){if(E){var A=!0;A&&I.ajax({type:"post",dataType:"json",url:urlController+"/principal/updatehistory",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:N.serialize(),success:function(I){I.estado===!0&&(location.href=urlController+"/principal/index",R("body","REGISTRADO","success","bar"))}})}}})},rules:{skills:"required"},messages:{skills:"Campo requerido"}},C=function(){l(),N.validate(O),s(),o(),i(),B(),E.datepicker.startView=2},l=function(){a.on("change",function(){I.post(Request.BaseUrl+"/"+Request.UrlHash.m+"/response/getSubResponsable",{ID_PRU_SUBGERENCIA:I("#pru").val(),ID_SUBGERENCIA:I(this).val(),id_bien:I("#ID_BIEN").val(),fecha:I("#FECHA_MODIFICACION").val()},function(E){I("#ID_RESPONSABLE").html(E.option)},"json")})},s=function(){_.on("change",function(){I.post(Request.BaseUrl+"/"+Request.UrlHash.m+"/response/getSubGerencia",{ID_PRU_GERENCIA_GENERAL:I("#ID_GERENCIA_GENERAL_PRU").val(),ID_GERENCIA:I(this).val(),id_bien:I("#ID_BIEN").val(),fecha:I("#FECHA_MODIFICACION").val()},function(E){I("#ID_SUBGERENCIA").html(E.option),I("#ID_RESPONSABLE").html(E.option_responsable)},"json")})},B=function(){t.on("change",function(){I.ajax({data:{id_bien:I("#ID_BIEN").val(),fecha:I(this).val()},type:"POST",dataType:"json",url:Request.BaseUrl+"/"+Request.UrlHash.m+"/Response/getDataByFecha",contentType:"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:function(){I("#barra").html('<div  class="progress"><div class="progress-bar-indeterminate progress-bar-success"></div></div>')},success:function(E){E.STATE===!0?setTimeout(function(){I("#barra").html(""),I("#CODIGO_PATRIMONIAL_BIEN").val(E.BIEN.CODIGO_PATRIMONIAL_BIEN),I("#DENOMINACION_BEIN").val(E.BIEN.DENOMINACION_BEIN),I("#ID_TIPO_CAUSAL").select2().val(E.BIEN.ID_TIPO_CAUSAL_ALTA).trigger("change"),I("#DENOMINACION_BEIN").val(E.BIEN.DENOMINACION_BEIN),I("#NUMERO_PECOSA").val(E.BIEN.NUMERO_PECOSA),I("#FECHA_PECOSA").val(E.FECHA.FECHA_PECOSA),I("#ID_DOC_ADQUISICION").select2().val(E.BIEN.ID_DOC_ADQUISICION).trigger("change"),I("#NUM_DOC_ADQUISICION").val(E.BIEN.NUM_DOC_ADQUISICION),I("#FECHA_ADQUISICION").val(E.FECHA.FECHA_ADQUISICION),I("#VALOR_ADQUISICION").val(E.BIEN.VALOR_ADQUIISICION),I("#ID_USO_CUENTA").select2().val(E.BIEN.ID_USO_CUENTA).trigger("change"),I("#ID_CUENTA").select2().val(E.BIEN.ID_CUENTA).trigger("change"),I("#NUM_CUENTA_CONTABLE").val(E.BIEN.NUM_CUENTA_CONTABLE),"SI"===E.BIEN.SEGURO_BIEN&&I("#SI").attr("checked",!0).trigger("click"),"NO"===E.BIEN.SEGURO_BIEN&&I("#NO").attr("checked",!0).trigger("click"),I("#ASEGURADORA_BIEN").val(E.BIEN.ASEGURADORA_BIEN),I("#NUM_POLIZA_ASEGURADORA").val(E.BIEN.NUM_POLIZA_ASEGURADORA),I("#FECHA_INICIO_ASEGURADO").val(E.FECHA.FECHA_INICIO),I("#FECHA_FIN_ASEGURADO").val(E.FECHA.FECHA_FIN),I("#ID_CONDICION").select2().val(E.BIEN.ID_CONDICION).trigger("change"),I("#RESOLUCION_BAJA").val(E.BIEN.RESOLUCION_BAJA),I("#FECHA_RESOLUCION_BAJA").val(E.FECHA.FECHA_RESOLUCION_BAJA),I("#ID_TIPO_CAUSAL_BAJA").val(E.BIEN.ID_TIPO_CAUSAL_BAJA),I("#MARCA_BIEN").val(E.BIEN.MARCA_BIEN),I("#MODELO_BIEN").val(E.BIEN.MODELO_BIEN),I("#TIPO_BIEN").val(E.BIEN.TIPO_BIEN),I("#COLOR_BIEN").val(E.BIEN.COLOR_BIEN),I("#SERIE_BIEN").val(E.BIEN.SERIE_BIEN),I("#DIMENSION_BIEN").val(E.BIEN.DIMENSION_BIEN),I("#ID_ESTADO_BIEN").select2().val(E.BIEN.ID_ESTADO_BIEN).trigger("change"),I("#PLACA_BIEN").val(E.BIEN.PLACA_BIEN),I("#NUM_MOTOR_BIEN").val(E.BIEN.NUM_MOTOR_BIEN),I("#NUM_CHASIS_BIEN").val(E.BIEN.NUM_CHASIS_BIEN),I("#ANIO_FABRICACION_BIEN").val(E.BIEN.ANIO_FABRICACION_BIEN),I("#LONGITUD_BIEN").val(E.BIEN.LONGITUD_BIEN),I("#ALTURA_BIEN").val(E.BIEN.ALTURA_BIEN),I("#ANCHO_BIEN").val(E.BIEN.ANCHO_BIEN),I("#RAZA_BIEN").val(E.BIEN.RAZA_BIEN),I("#ESPECIE_BIEN").val(E.BIEN.ESPECIE_BIEN),I("#EDAD_BIEN").val(E.BIEN.EDAD_BIEN),I("#PAIS_BIEN").val(E.BIEN.PAIS_BIEN),I("#OTRAS_CARACTERISTICAS").val(E.BIEN.OTRAS_CARACTERISTICAS_BIEN),I("#ID_ENTIDAD").select2().val(E.BIEN.ID_ENTIDAD).trigger("change"),I("#ID_LOCAL").select2().val(E.BIEN.ID_LOCAL).trigger("change"),I("#ID_GERENCIA_GENERAL_PRU").val(E.BIEN.ID_GERENCIA_GENERAL_PRU),I("#ID_GERENCIA_GENERAL").select2().val(E.BIEN.ID_GERENCIA_GENERAL_PRU).trigger("change"),I("#pru").val(E.BIEN.ID_GERENCIA),I("#ID_SUBGERENCIA").select2().val(E.BIEN.ID_GERENCIA).trigger("change"),I("#ID_RESPONSABLE").select2().val(E.BIEN.ID_RESPONSABLE).trigger("change"),I("#PISO_GERENCIA").val(E.BIEN.PISO_GERENCIA),I("#DESCRIPCION_UBICACION_BIEN").val(E.BIEN.DESCRIPCION_UBICACION_BIEN),I("#FECHA_DEPRECIACION").val(E.FECHA.FECHA_DEPRE),I("#VALOR_DEPRECIACION_EJERCICIO").val(E.VALOR_DEPRECIACION_EJERCICIO),I("#VALOR_DEPRECIACION_ACUMULADO").val(E.BIEN.VALOR_DEPRECIACION_ACUMULADO),I("#VALOR_NETO").val(E.BIEN.VALOR_NETO),I("#NUM_CUENTA").text(""!=E.BIEN.NUM_CUENTA_CONTABLE?"NUMERO CUENTA CONTABLE:"+E.BIEN.NUM_CUENTA_CONTABLE:""),I(".bloquear").attr("disabled",!0)},580):E.STATE===!1&&setTimeout(function(){I("#barra").html(""),I(".bloquear").attr("disabled",!1),I("#CODIGO_PATRIMONIAL_BIEN").val(E.BIEN.CODIGO_PATRIMONIAL_BIEN),I("#DENOMINACION_BEIN").val(E.BIEN.DENOMINACION_BEIN),I("#ID_TIPO_CAUSAL").select2().val(E.BIEN.ID_TIPO_CAUSAL_ALTA).trigger("change"),I("#DENOMINACION_BEIN").val(E.BIEN.DENOMINACION_BEIN),I("#NUMERO_PECOSA").val(E.BIEN.NUMERO_PECOSA),I("#FECHA_PECOSA").val(E.FECHA.FECHA_PECOSA),I("#ID_DOC_ADQUISICION").select2().val(E.BIEN.ID_DOC_ADQUISICION).trigger("change"),I("#NUM_DOC_ADQUISICION").val(E.BIEN.NUM_DOC_ADQUISICION),I("#FECHA_ADQUISICION").val(E.FECHA.FECHA_ADQUISICION),I("#VALOR_ADQUISICION").val(E.BIEN.VALOR_ADQUIISICION),I("#ID_USO_CUENTA").select2().val(E.BIEN.ID_USO_CUENTA).trigger("change"),I("#ID_CUENTA").select2().val(E.BIEN.ID_CUENTA).trigger("change"),I("#NUM_CUENTA_CONTABLE").val(E.BIEN.NUM_CUENTA_CONTABLE),"SI"===E.BIEN.SEGURO_BIEN&&I("#SI").attr("checked",!0).trigger("click"),"NO"===E.BIEN.SEGURO_BIEN&&I("#NO").attr("checked",!0).trigger("click"),I("#ASEGURADORA_BIEN").val(E.BIEN.ASEGURADORA_BIEN),I("#NUM_POLIZA_ASEGURADORA").val(E.BIEN.NUM_POLIZA_ASEGURADORA),I("#FECHA_INICIO_ASEGURADO").val(E.FECHA.FECHA_INICIO),I("#FECHA_FIN_ASEGURADO").val(E.FECHA.FECHA_FIN),I("#ID_CONDICION").select2().val(E.BIEN.ID_CONDICION).trigger("change"),I("#RESOLUCION_BAJA").val(E.BIEN.RESOLUCION_BAJA),I("#FECHA_RESOLUCION_BAJA").val(E.FECHA.FECHA_RESOLUCION_BAJA),I("#ID_TIPO_CAUSAL_BAJA").val(E.BIEN.ID_TIPO_CAUSAL_BAJA),I("#MARCA_BIEN").val(E.BIEN.MARCA_BIEN),I("#MODELO_BIEN").val(E.BIEN.MODELO_BIEN),I("#TIPO_BIEN").val(E.BIEN.TIPO_BIEN),I("#COLOR_BIEN").val(E.BIEN.COLOR_BIEN),I("#SERIE_BIEN").val(E.BIEN.SERIE_BIEN),I("#DIMENSION_BIEN").val(E.BIEN.DIMENSION_BIEN),I("#ID_ESTADO_BIEN").select2().val(E.BIEN.ID_ESTADO_BIEN).trigger("change"),I("#PLACA_BIEN").val(E.BIEN.PLACA_BIEN),I("#NUM_MOTOR_BIEN").val(E.BIEN.NUM_MOTOR_BIEN),I("#NUM_CHASIS_BIEN").val(E.BIEN.NUM_CHASIS_BIEN),I("#ANIO_FABRICACION_BIEN").val(E.BIEN.ANIO_FABRICACION_BIEN),I("#LONGITUD_BIEN").val(E.BIEN.LONGITUD_BIEN),I("#ALTURA_BIEN").val(E.BIEN.ALTURA_BIEN),I("#ANCHO_BIEN").val(E.BIEN.ANCHO_BIEN),I("#RAZA_BIEN").val(E.BIEN.RAZA_BIEN),I("#ESPECIE_BIEN").val(E.BIEN.ESPECIE_BIEN),I("#EDAD_BIEN").val(E.BIEN.EDAD_BIEN),I("#PAIS_BIEN").val(E.BIEN.PAIS_BIEN),I("#OTRAS_CARACTERISTICAS").val(E.BIEN.OTRAS_CARACTERISTICAS_BIEN),I("#ID_ENTIDAD").select2().val(E.BIEN.ID_ENTIDAD).trigger("change"),I("#ID_LOCAL").select2().val(E.BIEN.ID_LOCAL).trigger("change"),I("#ID_GERENCIA_GENERAL_PRU").val(""),I("#ID_GERENCIA_GENERAL").select2().val(E.BIEN.ID_GERENCIA_GENERAL_PRU).trigger("change"),I("#pru").val(""),I("#ID_SUBGERENCIA").select2().val(E.BIEN.ID_GERENCIA).trigger("change"),I("#ID_RESPONSABLE").select2().val(E.BIEN.ID_RESPONSABLE).trigger("change"),I("#PISO_GERENCIA").val(E.BIEN.PISO_GERENCIA),I("#DESCRIPCION_UBICACION_BIEN").val(E.BIEN.DESCRIPCION_UBICACION_BIEN),I("#FECHA_DEPRECIACION").val(E.FECHA.FECHA_DEPRE),I("#VALOR_DEPRECIACION_EJERCICIO").val(E.VALOR_DEPRECIACION_EJERCICIO),I("#VALOR_DEPRECIACION_ACUMULADO").val(E.BIEN.VALOR_DEPRECIACION_ACUMULADO),I("#VALOR_NETO").val(E.BIEN.VALOR_NETO),I("#NUM_CUENTA").text(""!=E.BIEN.NUM_CUENTA_CONTABLE?"NUMERO CUENTA CONTABLE:"+E.BIEN.NUM_CUENTA_CONTABLE:"")},580)}})})},o=function(){A.on("click",function(){I.post(Request.BaseUrl+"/patrimonio/principal/NuevaPersona",function(I){bootbox.dialog({closeButton:!1,message:I.layer}),n()},"json")})},n=function(){I("#btn_close").on("click",function(){bootbox.hideAll()}),I("#ID_GERENCIA").on("change",function(){I.post(Request.BaseUrl+"/patrimonio/response/getSubGerencia",{ID_GERENCIA:I(this).val()},function(E){I("#ID_SUB_GERENCIA").html(E.option)},"json")}),I("#NUMERO_DOCUMENTO_PERSONA").on("blur",function(){{var E=I(this).val();I("#TIPO_DOCUMENTO_PERSONA").val()}I.post(Request.BaseUrl+"/patrimonio/response/searchpersona",{numero_documento:E},function(E){if(E.STATE)if(E.RESPONSABLE){I(this).val("");var N=[];N.message='<div class="text-center"><i class="fa fa-warning"></i> Persona ya registrada</div>',N.style="flip",N.position="top",N.type="warning",N.showClose=!0,I(".modal-content").pgNotification(N).show()}else{var N=[];N.message='<div class="text-center"><i class="fa fa-check"></i> Resultados encontrados</div>',N.style="flip",N.position="top",N.type="success",N.showClose=!0,I(".modal-content").pgNotification(N).show(),I("#ID_PERSONA").val(E.PERSONA.ID_PERSONA),I("#NOMBRES_PERSONA").val(E.PERSONA.NOMBRES_PERSONA),I("#APELLIDO_PATERNO_PERSONA").val(E.PERSONA.APELLIDO_PATERNO_PERSONA),I("#APELLIDO_MATERNO_PERSONA").val(E.PERSONA.APELLIDO_MATERNO_PERSONA),I("#NOMBRES_PERSONA").attr("readonly",""),I("#APELLIDO_PATERNO_PERSONA").attr("readonly",""),I("#APELLIDO_MATERNO_PERSONA").attr("readonly","")}else{var N=[];N.message='<div class="text-center"><i class="fa fa-warning"></i> No se encontraron resultados</div>',N.style="flip",N.position="top",N.type="danger",N.showClose=!0,I(".modal-content").pgNotification(N).show()}},"json")}),I("#frm_respo").on("submit",function(){return I.post(Request.BaseUrl+"/gerencias/responsables/save",I("#frm_respo").serialize(),function(E){if(E.STATE){bootbox.hideAll();var N=[];N.message='<div class="text-center"><i class="fa fa-check"></i> Datos guardados</div>',N.style="flip",N.position="top",N.type="success",N.showClose=!0,I("body").pgNotification(N).show()}else{var N=[];N.message='<div class="text-center"><i class="fa fa-warning"></i> No se pudieron guardar los datos</div>',N.style="flip",N.position="top",N.type="danger",N.showClose=!0,I(".modal-content").pgNotification(N).show(),I("#dv_save").html('<button type="button" class="btn btn-danger" id="btn_close"><i class="fa fa-close"></i> Cancelar</button><button type="submit" class="btn btn-info" id="btn_save"><i class="fa fa-save"></i> Guardar</button>')}},"json"),!1})},i=function(){e.on("change",function(){var E=(I("#numero_documento").val(),I("#CODIGO_GRUPO").val()),N=I("#CODIGO_CLASE").val(),A=I("#ID_CUENTA").val();I.post(Request.BaseUrl+"/"+Request.UrlHash.m+"/response/getNumCuenta",{cod_grupo:E,cod_clase:N,tipo_cuenta:A},function(E){I("#NUM_CUENTA_CONTABLE").val(E.cuenta),I("#NUM_CUENTA").text(E.texto+E.cuenta)},"json")})},R=function(E,N,A,e){I(E).pgNotification({style:e,showClose:!1,message:"<center><b>"+N+"</b></center>",position:"top",timeout:3e3,type:A}).show()};return{init:C}}(window.jQuery),function(){HISTORY.history.init()}(window.jQuery);